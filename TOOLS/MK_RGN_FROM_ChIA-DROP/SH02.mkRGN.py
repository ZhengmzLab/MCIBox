"""
(base) [stian@localhost 1.3.61.INTERTF]$ head P2CDB.Fragnum_PlinePgem.gemline.cmb
GEM_ID	GEM_coordinate	GEM_span	Fragment_number	List_of_fragment_coordinates
SHG0040H-100000022-AAACACCAGAAGGTGABX1040-FA-1-0	chr3L:8185447-23395328	15209881	3	chr3L:8185447-8186660(0);chr3L:20444391-20445060(1);chr3L:23394505-23395328(2)
SHG0040H-100000041-AAACACCAGACCACGABX1040-FA-1-0	chr2L:2754881-17008984	14254103	3	chr2L:2754881-2755509(0);chr2L:5049344-5049972(1);chr2L:17008356-17008984(2)
SHG0040H-100000174-AAACACCAGCCTAACTBX1040-FA-1-0	chrX:14057885-21835530	7777645	2	chrX:14057885-14058513(0);chrX:21834847-21835530(1)
SHG0040H-100000177-AAACACCAGCCTCAATBX1040-FA-1-0	chr3R:4583484-23288320	18704836	3	chr3R:4583484-4584099(0);chr3R:10966151-10967004(1);chr3R:23287114-23288320(2)
SHG0040H-100000218-AAACACCAGCTAGGCABX1040-FA-1-0	chr2R:7650640-18823665	11173025	2	chr2R:7650640-7651268(0);chr2R:18822843-18823665(1)

SHG0040H
SHG0048H2
SHG0058H
SHG0021N
SHG0057H
SHG0051H
SHG0048H
SHG0022N

"""
D={"SHG0040H":400,"SHG0048H2":482,"SHG0058H":580,"SHG0021N":210,"SHG0057H":570,"SHG0051H":510,"SHG0048H":480,"SHG0022N":220}
print(D)
IN="Nature.P2CDP.gemline"
FIN=open(IN,"r")
FOUT=open(IN+".RGN","w")

while True:
	line=FIN.readline()
	if line.startswith("GEM_ID"):
		continue
	if not line:
		break
	word=line.rstrip("\n").split("\t")
	GEM_ID=word[0]
	LIB=GEM_ID.split("-")[0]

	ID=int(GEM_ID.split("-")[1])	
	NID=str((ID-100000000)+D[LIB]*100000000)
	BC=GEM_ID.split("-")[2].split("BX")[0]
	LIBBC=LIB+"-"+BC
	TYPE=GEM_ID.split("-")[3]
	Fragment_number=int(word[3])
	List_of_fragment_coordinates=word[4]
	FRAGS=List_of_fragment_coordinates.split(";")
	GEMINFO="|".join(word)
	for FRAG in FRAGS:
		C=FRAG.split(":")[0]
		S=FRAG.split(":")[1].split("-")[0]
		E=FRAG.split("-")[1].split("(")[0]
		NEWID="-".join([LIB,NID,BC])
		newline="\t".join([C,S,E,str(Fragment_number),NEWID])
		FOUT.write(newline+"\n")


"""
chr3L	8185447	8186660	SHG0040H-AAACACCAGAAGGTGA	FA	SHG0040H-100000022-AAACACCAGAAGGTGABX1040-FA-1-0|chr3L:8185447-23395328|15209881|3|chr3L:8185447-8186660(0);chr3L:20444391-20445060(1);chr3L:23394505-23395328(2)
"""	
